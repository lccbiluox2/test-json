package com.fastjson.compare;

import org.junit.Test;

import static org.junit.Assert.*;

public class CompareTwoDataTest {

    private CompareTwoData compareTwoData = new CompareTwoData();

    @Test
    public void compareTwoData() {
        String dataA = "{\"loginId\":\"yye5\",\"dvcAction\":\"permitted\",\"sendHostAddress\":\"10.119.79.15\",\"baas_sink_process_time\":1714126278799,\"eventCount\":\"1\",\"srcPort\":\"55176\",\"deviceReceiptTime\":\"2024-04-26 18:04:03\",\"deviceId\":\"1009\",\"deviceName\":\"CNSHASRV265\",\"responseCode\":\"0\",\"destAddress\":\"43.129.157.18\",\"XFF\":\"10.119.140.70\",\"destHostName\":\"43.129.157.18\",\"deviceCat\":\"/OperatingSystem\",\"eventId\":\"704032019402724851|fedc6be1-86eb-4276-90ae-e9cbc6080719\",\"srcGeoCity\":\"局域网\",\"destGeoIsp\":\"腾讯\",\"machineCode\":\"nbc8df0w1yfg1b127ir4o6dnl-2130706433\",\"policyName\":\"Super_Administrator**CN-POL_No_Access,Super_Administrator**Default\",\"destGeoLongitude\":\"114.184921\",\"netId\":\"24bd4a22-d219-11ee-ba61-02424e76012f_1708671592\",\"srcAddress\":\"10.119.142.64\",\"eventType\":\"1\",\"srcGeoCounty\":\"局域网\",\"srcGeoCountry\":\"局域网\",\"srcOrgId\":\"24bd4a22-d219-11ee-ba61-02424e76012f_1708671592\",\"productVendorName\":\"Websense\",\"catObject\":\"/Host/OperatingSystem\",\"deviceSendProductName\":\"forcepoint-proxy代理\",\"catTechnique\":\"/UNKNOW\",\"name\":\"上网访问请求被允许\",\"destGeoRegion\":\"中国香港\",\"catOutcome\":\"Attempt\",\"deviceProtocol\":\"syslog\",\"rawEvent\":\"<159>Apr 26 18:04:03 10.119.140.70 vendor=Forcepoint product=Security product_version=8.5.4 action=permitted severity=1 category=148 user=LDAP://cnshagc101.cn.kworld.kpmg.com CN\\\\=Users,DC\\\\=cn,DC\\\\=kworld,DC\\\\=kpmg,DC\\\\=com/yye5 loginID=yye5 src_host=10.119.142.64 src_port=55176 dst_host=43.129.157.18 dst_ip=43.129.157.18 dst_port=80 bytes_out=353 bytes_in=0 http_response=0 http_method=GET http_content_type=- http_user_agent=Mozilla/5.0_(Windows_NT_10.0;_Win64;_x64;_rv:125.0)_Gecko/20100101_Firefox/125.0 http_proxy_status_code=502 reason=- disposition=1048 policy=Super_Administrator**CN-POL_No_Access,Super_Administrator**Default role=8 duration=0 url=http://43.129.157.18/favicon.ico logRecordSource=%<logRecordSource>\",\"collectorReceiptTime\":\"2024-04-26 18:11:53\",\"requestMethod\":\"GET\",\"appProtocol\":\"http\",\"destSecurityZone\":\"outer\",\"accessAgent\":\"Mozilla/5.0_(Windows_NT_10.0;_Win64;_x64;_rv:125.0)_Gecko/20100101_Firefox/125.0\",\"deviceAddress\":\"10.166.1.226\",\"destPort\":\"80\",\"destGeoCountry\":\"中国\",\"deviceProductType\":\"Proxy\",\"customerId\":\"1002\",\"startTime\":\"2024-04-26 18:04:03\",\"destGeoCountryCode\":\"CN\",\"bytesOut\":\"0\",\"bytesIn\":\"353\",\"destGeoCity\":\"中国香港\",\"direction\":\"01\",\"severity\":\"1\",\"destOrgId\":\"outer\",\"srcSecurityZone\":\"inner_26c16a9a-d219-11ee-ba61-02424e76012f_1708671596\",\"message\":\"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb\",\"destGeoCounty\":\"\",\"otherFields\":\"{\\\"reason\\\":\\\"\\\\\\\"-\\\\\\\"\\\",\\\"role\\\":\\\"\\\\\\\"8\\\\\\\"\\\",\\\"collectorProtocol\\\":\\\"\\\\\\\"syslog\\\\\\\"\\\",\\\"finalMapperId\\\":\\\"\\\\\\\"23c49a69-065b-4b20-9114-207f3487125c\\\\\\\"\\\",\\\"http_proxy_status_code\\\":\\\"\\\\\\\"502\\\\\\\"\\\",\\\"duration\\\":\\\"\\\\\\\"0 \\\\\\\"\\\",\\\"disposition\\\":\\\"\\\\\\\"1048\\\\\\\"\\\",\\\"http_content_type\\\":\\\"\\\\\\\"-\\\\\\\"\\\",\\\"categoryTypeId\\\":\\\"\\\\\\\"148\\\\\\\"\\\",\\\"collectorReceiptTimeMS\\\":\\\"\\\\\\\"1714126313708\\\\\\\"\\\",\\\"assetCategoryName\\\":\\\"\\\\\\\"主机类/Windows\\\\\\\"\\\",\\\"deviceHostName\\\":\\\"\\\\\\\"CNSHASRV265\\\\\\\"\\\",\\\"categoryId\\\":\\\"\\\\\\\"1\\\\\\\"\\\"}\",\"requestUrlQuery\":\"http://43.129.157.18/favicon.ico\",\"destGeoLatitude\":\"22.350617\",\"baas_srcDestAddress\":\"10.119.142.64#24bd4a22-d219-11ee-ba61-02424e76012f_1708671592#43.129.157.18#outer\",\"@timestamp\":\"2024-04-26T10:11:53.000Z\",\"baas_engineInfo\":\"info:78.118.1.83,5.datanode2\",\"catBehavior\":\"/UNKNOW\",\"catSignificance\":\"/Informational\",\"endTime\":\"2024-04-26 18:04:03\",\"category\":\"Miscellaneous: Web Images\",\"srcGeoRegion\":\"局域网\"}";
        String dataB = "{\"deviceProtocol\":\"syslog\",\"collectorProtocol\":\"syslog\",\"deviceId\":\"1506\",\"deviceName\":\"CNCTUFW05\",\"deviceHostName\":\"CNCTUFW05\",\"deviceAddress\":\"10.119.140.2\",\"categoryId\":\"12\",\"assetCategoryName\":\"安全类/下一代防火墙\",\"customerId\":\"1003\",\"eventId\":\"703926000982956747|5dffe2fc-34b5-439b-94cb-139f5470cde2\",\"rawEvent\":\"<14>Apr 26 11:10:35 CNCTUFW05.cn.kworld.kpmg.com 1,2024/04/26 11:10:34,012001077053,TRAFFIC,end,2562,2024/04/26 11:10:34,10.119.140.70,43.129.157.18,118.112.177.120,43.129.157.18,Proxy,,,incomplete,vsys1,sz_INET_Trust,sz_INET_Untrust,ethernet1/2,ethernet1/1,PA.CDK.Main Pipe,2024/04/26 11:10:34,21776,1,60350,80,50525,80,0x400019,tcp,allow,74,74,0,1,2024/04/26 11:10:28,0,any,,7344643115942141707,0x0,10.0.0.0-10.255.255.255,Hong Kong,,1,0,aged-out,498,543,547,36958,,CNCTUFW05,from-policy,,,0,,0,,N/A,0,0,0,0,ee2da6c8-bef4-48ac-8541-261727590e0a,0,0,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,2024-04-26T11:10:35.619+08:00,,,unknown,unknown,unknown,1,,,incomplete,no,no,0\",\"collectorReceiptTime\":\"2024-04-26 11:10:36\",\"name\":\"通信结束\",\"message\":\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\",\"deviceCat\":\"/Firewall\",\"catObject\":\"/Host/Application/Service\",\"catBehavior\":\"/Access/Stop\",\"catTechnique\":\"/UNKNOW\",\"catOutcome\":\"OK\",\"catSignificance\":\"/Informational\",\"severity\":\"1\",\"productVendorName\":\"PaloAlto\",\"deviceSendProductName\":\"WildFire\",\"deviceReceiptTime\":\"2024-04-26 11:10:34\",\"hostName\":\"CNCTUFW05.cn.kworld.kpmg.com\",\"futureUse\":\"2024/04/26 11:10:34\",\"recvTime\":\"2024/04/26 11:10:34\",\"serialNum\":\"012001077053\",\"logType\":\"TRAFFIC\",\"subType\":\"end\",\"gerneratedTime\":\"2024-04-26 11:10:34\",\"srcAddress\":\"10.119.140.70\",\"destAddress\":\"43.129.157.18\",\"srcTransAddress\":\"118.112.177.120\",\"destTransAddress\":\"43.129.157.18\",\"endTime\":\"2024-04-26 11:10:28\",\"startTime\":\"2024-04-26 11:10:28\",\"deviceProductType\":\"防火墙\",\"application\":\"incomplete\",\"vsysName\":\"vsys1\",\"srcZone\":\"sz_INET_Trust\",\"destZone\":\"sz_INET_Untrust\",\"dvcInInterface\":\"ethernet1/2\",\"dvcOutInterface\":\"ethernet1/1\",\"logForwardingProfile\":\"PA.CDK.Main Pipe\",\"sessionid\":\"21776\",\"srcPort\":\"60350\",\"destPort\":\"80\",\"srcTransPort\":\"50525\",\"destTransPort\":\"80\",\"flags\":\"0x400019\",\"protocol\":\"tcp\",\"dvcAction\":\"allow\",\"bytesInAndOut\":\"74\",\"bytesOut\":\"74\",\"bytesIn\":\"0\",\"pktsInAndOut\":\"1\",\"durationTime\":\"0.0\",\"trafficCategory\":\"any\",\"seqNo\":\"7344643115942141707\",\"actionflags\":\"0x0\",\"srcLoc\":\"10.0.0.0-10.255.255.255\",\"destLoc\":\"Hong Kong\",\"pktsOut\":\"1\",\"pktsIn\":\"0\",\"sessionEndReason\":\"aged-out\",\"deviceGroupHierarchylevel1\":\"498\",\"deviceGroupHierarchylevel2\":\"543\",\"deviceGroupHierarchylevel3\":\"547\",\"deviceGroupHierarchylevel4\":\"36958\",\"dvcName\":\"CNCTUFW05\",\"actionSource\":\"from-policy\",\"eventType\":\"1\",\"transProtocol\":\"TCP\",\"appProtocol\":\"http\",\"srcGeoCity\":\"局域网\",\"srcGeoCountry\":\"局域网\",\"srcGeoCounty\":\"局域网\",\"srcGeoRegion\":\"局域网\",\"destGeoCity\":\"中国香港\",\"destGeoCountry\":\"中国\",\"destGeoCounty\":\"\",\"destGeoRegion\":\"中国香港\",\"destGeoCountryCode\":\"CN\",\"destGeoIsp\":\"腾讯\",\"destGeoLatitude\":\"22.350617\",\"destGeoLongitude\":\"114.184921\",\"finalMapperId\":\"79e4d730-b468-47a6-864b-edab8a25ba6d\",\"eventCount\":\"1\",\"collectorReceiptTimeMS\":\"1714101036947\",\"machineCode\":\"nbc8df0w1yfg1b127ir4o6dnl-2130706433\",\"sendHostAddress\":\"10.119.79.15\"}";

        compareTwoData.compareTwoData(dataA,dataB);
    }
}